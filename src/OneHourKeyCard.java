
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;

public class OneHourKeyCard {
    public static void main(String[] args) {
        String[] keyNames = {"aa","aa","aa","aa","aa","aa","aa","aa","aa","aa","ba","ba","ba","ba","ba","ba","ba","ba","ba","ba","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","da","da","da","da","da","da","da","da","da","da","ea","ea","ea","ea","ea","ea","ea","ea","ea","ea","fa","fa","fa","fa","fa","fa","fa","fa","fa","fa","ga","ga","ga","ga","ga","ga","ga","ga","ga","ga","ha","ha","ha","ha","ha","ha","ha","ha","ha","ha","ia","ia","ia","ia","ia","ia","ia","ia","ia","ia","ja","ja","ja","ja","ja","ja","ja","ja","ja","ja","ka","ka","ka","ka","ka","ka","ka","ka","ka","ka","la","la","la","la","la","la","la","la","la","la","ma","ma","ma","ma","ma","ma","ma","ma","ma","ma","na","na","na","na","na","na","na","na","na","na","oa","oa","oa","oa","oa","oa","oa","oa","oa","oa","pa","pa","pa","pa","pa","pa","pa","pa","pa","pa","qa","qa","qa","qa","qa","qa","qa","qa","qa","qa","ra","ra","ra","ra","ra","ra","ra","ra","ra","ra","sa","sa","sa","sa","sa","sa","sa","sa","sa","sa","ta","ta","ta","ta","ta","ta","ta","ta","ta","ta","ua","ua","ua","ua","ua","ua","ua","ua","ua","ua","va","va","va","va","va","va","va","va","va","va","wa","wa","wa","wa","wa","wa","wa","wa","wa","wa","xa","xa","xa","xa","xa","xa","xa","xa","xa","xa","ya","ya","ya","ya","ya","ya","ya","ya","ya","ya","za","za","za","za","za","za","za","za","za","za","ab","ab","ab","ab","ab","ab","ab","ab","ab","ab","bb","bb","bb","bb","bb","bb","bb","bb","bb","bb","cb","cb","cb","cb","cb","cb","cb","cb","cb","cb","db","db","db","db","db","db","db","db","db","db","eb","eb","eb","eb","eb","eb","eb","eb","eb","eb","fb","fb","fb","fb","fb","fb","fb","fb","fb","fb","gb","gb","gb","gb","gb","gb","gb","gb","gb","gb","hb","hb","hb","hb","hb","hb","hb","hb","hb","hb","ib","ib","ib","ib","ib","ib","ib","ib","ib","ib","jb","jb","jb","jb","jb","jb","jb","jb","jb","jb","kb","kb","kb","kb","kb","kb","kb","kb","kb","kb","lb","lb","lb","lb","lb","lb","lb","lb","lb","lb","mb","mb","mb","mb","mb","mb","mb","mb","mb","mb","nb","nb","nb","nb","nb","nb","nb","nb","nb","nb","ob","ob","ob","ob","ob","ob","ob","ob","ob","ob","pb","pb","pb","pb","pb","pb","pb","pb","pb","pb","qb","qb","qb","qb","qb","qb","qb","qb","qb","qb","rb","rb","rb","rb","rb","rb","rb","rb","rb","rb","sb","sb","sb","sb","sb","sb","sb","sb","sb","sb","tb","tb","tb","tb","tb","tb","tb","tb","tb","tb","ub","ub","ub","ub","ub","ub","ub","ub","ub","ub","vb","vb","vb","vb","vb","vb","vb","vb","vb","vb","wb","wb","wb","wb","wb","wb","wb","wb","wb","wb","xb","xb","xb","xb","xb","xb","xb","xb","xb","xb"};
        String[] keyTimes = {"01:43","20:58","09:42","21:48","16:03","23:03","00:18","15:16","16:26","18:27","17:12","08:59","19:42","13:08","20:17","15:48","03:05","22:45","20:51","15:56","13:18","21:19","07:35","00:37","18:05","20:01","20:40","01:16","11:20","01:02","13:33","07:41","04:56","01:29","06:26","23:37","08:09","01:53","17:50","15:20","12:19","02:06","00:13","09:13","03:42","09:04","02:38","06:40","02:40","19:03","12:24","20:37","08:01","19:24","16:12","06:36","16:06","01:29","19:29","00:51","08:43","19:34","01:27","11:43","21:09","20:35","04:21","02:54","22:39","03:25","03:33","10:52","04:11","19:55","10:25","16:08","07:08","11:54","10:24","03:06","01:34","13:13","15:19","19:25","00:56","14:09","01:15","16:51","14:34","02:35","10:39","22:41","09:51","00:44","15:55","10:25","14:54","03:11","05:40","17:20","16:33","22:35","15:24","03:51","14:58","21:24","01:40","10:13","22:43","02:28","14:57","06:40","20:19","00:13","04:01","06:39","12:40","19:49","16:36","21:19","03:57","13:36","03:51","04:02","07:28","04:12","18:59","21:10","21:06","20:58","19:21","17:24","23:24","06:16","18:22","17:56","06:54","05:13","19:28","00:05","22:24","07:43","02:53","16:00","21:20","22:45","07:08","17:41","03:16","02:43","07:47","11:17","16:27","00:10","19:14","09:08","08:34","07:30","14:38","13:34","09:01","11:28","01:04","12:42","13:01","17:06","23:37","12:44","17:57","22:40","16:08","03:15","15:31","13:27","03:04","13:51","16:36","21:24","04:17","13:02","02:52","09:33","18:33","23:07","00:51","22:36","18:49","19:28","16:41","00:16","01:11","20:39","06:51","01:52","10:45","22:16","12:36","17:21","08:45","11:26","23:44","19:33","13:47","05:47","20:40","03:35","10:05","11:40","21:13","13:21","08:52","19:07","22:11","09:57","09:30","15:16","10:19","04:09","06:09","12:53","01:48","08:24","01:56","19:04","16:52","02:57","12:14","07:31","21:11","17:42","15:09","19:28","12:07","11:35","02:56","18:17","11:34","16:48","00:43","21:14","06:22","13:14","19:56","07:50","10:50","17:45","23:26","17:22","02:23","03:20","00:01","07:28","05:54","04:20","10:16","19:15","12:25","05:26","10:15","09:47","12:38","22:17","18:01","14:13","08:18","21:19","04:52","19:32","21:00","17:09","09:30","22:20","22:11","16:33","02:24","23:54","12:53","16:10","09:29","23:35","20:50","23:04","18:56","14:56","21:28","02:50","13:10","15:40","09:41","15:18","12:28","21:19","15:34","09:56","03:01","08:44","15:28","05:24","11:27","05:49","09:39","19:27","19:55","13:13","23:04","05:42","05:15","06:24","18:17","11:22","16:27","17:31","06:46","14:55","17:53","16:12","02:04","11:20","17:15","14:00","05:35","00:57","15:13","02:02","20:21","07:02","00:39","10:22","12:48","10:14","08:30","08:29","12:02","03:47","15:55","03:01","19:24","02:06","04:04","05:47","01:33","01:58","22:12","17:11","04:10","07:35","20:04","17:08","13:45","19:29","06:35","00:53","07:29","03:09","09:32","19:25","09:39","03:48","21:25","05:19","09:57","18:57","14:49","04:55","10:27","03:53","21:33","14:11","13:45","10:29","20:06","22:10","20:15","00:38","16:40","15:48","16:57","00:00","09:23","19:33","03:30","20:30","18:34","22:01","15:40","09:27","05:42","19:41","06:12","12:54","02:06","01:59","00:08","21:39","00:46","07:33","14:10","12:01","21:46","19:21","12:23","16:50","12:20","12:43","23:27","09:24","03:32","13:47","23:52","13:53","17:22","14:56","05:19","15:49","04:14","22:17","11:59","06:03","12:57","13:36","04:47","10:24","13:47","16:11","20:06","02:14","04:51","03:41","10:47","12:26","21:03","20:02","21:49","00:40","06:52","15:58","18:03","23:49","12:32","05:07","00:43","13:56","06:57","12:01","09:26","06:50","12:34","00:25","06:39","00:30","04:27","02:22","07:33","19:27","21:01","21:20","22:21","07:49","15:42","09:06","10:31","19:41","16:31","06:58","19:08","21:49","15:29","06:38","09:13","02:38","08:14","15:06","05:49","21:53","22:21","15:53","06:36","19:37","13:22","00:35","18:27","08:00","10:26","08:01","13:51","05:34","02:25","21:50","21:48","22:40","07:04","02:31","02:10","22:09","16:57","21:02","04:29","05:22","04:35","05:36"};
        String[] cN = {"c","c","c","c","c","c","c","c","c"};
        String[] cT = {"02:19","05:37","07:08","10:08","10:12","21:54","22:09","22:29","23:44"};
        String[] dN = {"d","d","d","d","d","d","d","d","d"};
        String[] dT = {"07:06","02:48","01:40","10:16","01:36","14:53","10:32","09:50","07:16"};
        String[] eN = {"e","e","e","e","e","e"};
        String[] eT = {"12:41","19:43","06:06","18:50","19:18","12:14"};

        System.out.println(alertNames(keyNames,keyTimes));
    }
    public static List<String> alertNames(String[] keyName, String[] keyTime) {
        List<String> perps = new ArrayList<>();
        int[] keyTimeAdjusted = new int[keyTime.length];
        for(int i = 0; i< keyTime.length; i++){
            keyTimeAdjusted[i] = keyTime[i].charAt(0)*600+keyTime[i].charAt(1)*60+keyTime[i].charAt(3)*10+keyTime[i].charAt(4)-32208;
        }
        for (int i = 0; i < keyTimeAdjusted.length; i++) {
            for (int j = i + 1; j < keyTimeAdjusted.length; j++) {
                int temp1 = 0;
                String temp2 = "";
                if (keyTimeAdjusted[j] < keyTimeAdjusted[i]) {
                    temp1 = keyTimeAdjusted[i];
                    temp2 = keyName[i];
                    keyTimeAdjusted[i] = keyTimeAdjusted[j];
                    keyName[i] = keyName[j];
                    keyTimeAdjusted[j] = temp1;
                    keyName[j] = temp2;
                }
            }
        }
        HashMap<String,Integer> map1 = new HashMap<>();
        HashMap<String, Integer> map2 = new HashMap<>();
        HashMap<String, Integer> map3 = new HashMap<>();
        for(int i = 0; i< keyName.length; i++){
            if (map1.containsKey(keyName[i])){
                if (map1.get(keyName[i]) +60 >= keyTimeAdjusted[i]&&keyTimeAdjusted[i] > map1.get(keyName[i])){
                    int c = map2.get(keyName[i]);
                    if(c == 2){
                        if(!perps.contains(keyName[i])) {
                            perps.add(keyName[i]);
                        }
                    }
                    map3.put(keyName[i], keyTimeAdjusted[i]);
                    map2.remove(keyName[i]);
                    map2.put(keyName[i],c+1);
                } else{
                    map1.remove(keyName[i]);
                    map2.remove(keyName[i]);
                    if(map3.containsKey(keyName[i])&&map3.get(keyName[i])+60>= keyTimeAdjusted[i]) {
                        map1.put(keyName[i], map3.get(keyName[i]));
                        map2.put(keyName[i],2);
                    } else if(map3.containsKey(keyName[i])&&map3.get(keyName[i])+60< keyTimeAdjusted[i]){
                        map1.put(keyName[i],keyTimeAdjusted[i]);
                        map2.put(keyName[i],1);
                        map3.put(keyName[i],keyTimeAdjusted[i]);
                    }else {
                        map1.put(keyName[i], keyTimeAdjusted[i]);
                        map2.put(keyName[i],1);
                        map3.put(keyName[i], keyTimeAdjusted[i]);
                    }
                    map3.remove(keyName[i]);
                }
            }
            else{
                map1.put(keyName[i],keyTimeAdjusted[i]);
                map2.put(keyName[i],1);
            }
        }
        Collections.sort(perps);
        return perps;
    }
}
